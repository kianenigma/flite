<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `mpin` mod in crate `snowbridge_milagro_bls`."><title>snowbridge_milagro_bls::BLSCurve::mpin - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-b25d77b18a16a9a4.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="snowbridge_milagro_bls" data-themes="" data-resource-suffix="" data-rustdoc-version="1.82.0-nightly (13a52890d 2024-08-14)" data-channel="nightly" data-search-js="search-ef54e092fea9c776.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../../static.files/storage-118b08c4c78b968e.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../../static.files/main-cb0df477c2d67d00.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-3b12f09e550e0385.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../snowbridge_milagro_bls/index.html">snowbridge_<wbr>milagro_<wbr>bls</a><span class="version">1.5.4</span></h2></div><h2 class="location"><a href="#">Module mpin</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#constants">Constants</a></li><li><a href="#functions">Functions</a></li></ul></section><h2><a href="../index.html">In snowbridge_<wbr>milagro_<wbr>bls::<wbr>BLSCurve</a></h2></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../../index.html">snowbridge_milagro_bls</a>::<wbr><a href="../index.html">BLSCurve</a>::<wbr><a class="mod" href="#">mpin</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../../../src/snowbridge_amcl/lib.rs.html#120">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><h2 id="constants" class="section-header">Constants<a href="#constants" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="constant" href="constant.BAD_PARAMS.html" title="constant snowbridge_milagro_bls::BLSCurve::mpin::BAD_PARAMS">BAD_<wbr>PARAMS</a></div></li><li><div class="item-name"><a class="constant" href="constant.BAD_PIN.html" title="constant snowbridge_milagro_bls::BLSCurve::mpin::BAD_PIN">BAD_PIN</a></div></li><li><div class="item-name"><a class="constant" href="constant.EFS.html" title="constant snowbridge_milagro_bls::BLSCurve::mpin::EFS">EFS</a></div></li><li><div class="item-name"><a class="constant" href="constant.EGS.html" title="constant snowbridge_milagro_bls::BLSCurve::mpin::EGS">EGS</a></div></li><li><div class="item-name"><a class="constant" href="constant.INVALID_POINT.html" title="constant snowbridge_milagro_bls::BLSCurve::mpin::INVALID_POINT">INVALI<wbr>D_<wbr>POINT</a></div></li><li><div class="item-name"><a class="constant" href="constant.MAXPIN.html" title="constant snowbridge_milagro_bls::BLSCurve::mpin::MAXPIN">MAXPIN</a></div></li><li><div class="item-name"><a class="constant" href="constant.PBLEN.html" title="constant snowbridge_milagro_bls::BLSCurve::mpin::PBLEN">PBLEN</a></div></li><li><div class="item-name"><a class="constant" href="constant.SHA256.html" title="constant snowbridge_milagro_bls::BLSCurve::mpin::SHA256">SHA256</a></div></li><li><div class="item-name"><a class="constant" href="constant.SHA384.html" title="constant snowbridge_milagro_bls::BLSCurve::mpin::SHA384">SHA384</a></div></li><li><div class="item-name"><a class="constant" href="constant.SHA512.html" title="constant snowbridge_milagro_bls::BLSCurve::mpin::SHA512">SHA512</a></div></li><li><div class="item-name"><a class="constant" href="constant.TRAP.html" title="constant snowbridge_milagro_bls::BLSCurve::mpin::TRAP">TRAP</a></div></li><li><div class="item-name"><a class="constant" href="constant.TS.html" title="constant snowbridge_milagro_bls::BLSCurve::mpin::TS">TS</a></div></li><li><div class="item-name"><a class="constant" href="constant.WRONG_ORDER.html" title="constant snowbridge_milagro_bls::BLSCurve::mpin::WRONG_ORDER">WRON<wbr>G_<wbr>ORDER</a></div></li></ul><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.client_1.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::client_1">client_<wbr>1</a></div><div class="desc docblock-short">Implement step 1 on client side of MPin protocol</div></li><li><div class="item-name"><a class="fn" href="fn.client_2.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::client_2">client_<wbr>2</a></div><div class="desc docblock-short">Implement step 2 on client side of MPin protocol</div></li><li><div class="item-name"><a class="fn" href="fn.client_key.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::client_key">client_<wbr>key</a></div><div class="desc docblock-short">Calculate common key on client side
wCID = w.(A+AT)</div></li><li><div class="item-name"><a class="fn" href="fn.decoding.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::decoding">decoding</a></div></li><li><div class="item-name"><a class="fn" href="fn.encoding.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::encoding">encoding</a></div></li><li><div class="item-name"><a class="fn" href="fn.extract_factor.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::extract_factor">extract_<wbr>factor</a></div><div class="desc docblock-short">Extract factor from TOKEN for identity CID</div></li><li><div class="item-name"><a class="fn" href="fn.extract_pin.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::extract_pin">extract_<wbr>pin</a></div><div class="desc docblock-short">Extract PIN from TOKEN for identity CID</div></li><li><div class="item-name"><a class="fn" href="fn.get_client_permit.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::get_client_permit">get_<wbr>client_<wbr>permit</a></div><div class="desc docblock-short">Time Permit CTT=S*(date|H(CID)) where S is master secret</div></li><li><div class="item-name"><a class="fn" href="fn.get_client_secret.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::get_client_secret">get_<wbr>client_<wbr>secret</a></div><div class="desc docblock-short">Client secret CST=S*H(CID) where CID is client ID and S is master secret
CID is hashed externally</div></li><li><div class="item-name"><a class="fn" href="fn.get_g1_multiple.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::get_g1_multiple">get_<wbr>g1_<wbr>multiple</a></div><div class="desc docblock-short">W=x<em>H(G);
if RNG == NULL then X is passed in
if RNG != NULL the X is passed out
if type=0 W=x</em>G where G is point on the curve, else W=x*M(G), where M(G) is mapping of octet G to point on the curve</div></li><li><div class="item-name"><a class="fn" href="fn.get_server_secret.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::get_server_secret">get_<wbr>server_<wbr>secret</a></div><div class="desc docblock-short">Extract Server Secret SST=S*Q where Q is fixed generator in G2 and S is master secret</div></li><li><div class="item-name"><a class="fn" href="fn.get_y.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::get_y">get_y</a></div><div class="desc docblock-short">Generate Y = H(epoch, xCID/xID)</div></li><li><div class="item-name"><a class="fn" href="fn.hash_all.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::hash_all">hash_<wbr>all</a></div><div class="desc docblock-short">Hash the M-Pin transcript - new</div></li><li><div class="item-name"><a class="fn" href="fn.hash_id.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::hash_id">hash_id</a></div></li><li><div class="item-name"><a class="fn" href="fn.kangaroo.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::kangaroo">kangaroo</a></div><div class="desc docblock-short">Pollards kangaroos used to return PIN error</div></li><li><div class="item-name"><a class="fn" href="fn.precompute.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::precompute">precompute</a></div><div class="desc docblock-short">Functions to support M-Pin Full</div></li><li><div class="item-name"><a class="fn" href="fn.random_generate.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::random_generate">random_<wbr>generate</a></div><div class="desc docblock-short">create random secret S</div></li><li><div class="item-name"><a class="fn" href="fn.recombine_g1.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::recombine_g1">recombine_<wbr>g1</a></div><div class="desc docblock-short">R=R1+R2 in group G1</div></li><li><div class="item-name"><a class="fn" href="fn.recombine_g2.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::recombine_g2">recombine_<wbr>g2</a></div><div class="desc docblock-short">W=W1+W2 in group G2</div></li><li><div class="item-name"><a class="fn" href="fn.restore_factor.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::restore_factor">restore_<wbr>factor</a></div><div class="desc docblock-short">Restore factor to TOKEN for identity CID</div></li><li><div class="item-name"><a class="fn" href="fn.server_1.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::server_1">server_<wbr>1</a></div><div class="desc docblock-short">Outputs H(CID) and H(T|H(CID)) for time permits. If no time permits set HID=HTID</div></li><li><div class="item-name"><a class="fn" href="fn.server_2.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::server_2">server_<wbr>2</a></div><div class="desc docblock-short">Implement step 2 of MPin protocol on server side</div></li><li><div class="item-name"><a class="fn" href="fn.server_key.html" title="fn snowbridge_milagro_bls::BLSCurve::mpin::server_key">server_<wbr>key</a></div><div class="desc docblock-short">calculate common key on server side
Z=r.A - no time permits involved</div></li></ul></section></div></main></body></html>